# 結婚式ウェブサイト機能拡張タスクリスト

## 実装状況の概要
- [x] QRコードチェックイン機能：100%完了（メインブランチへマージ済み）
- [x] チェックイン後の案内表示機能：100%完了（メインブランチへマージ済み）
- [x] ブランチ戦略導入：100%完了
- [ ] 管理者用リアルタイムダッシュボード：未着手（優先度：高）
- [ ] デジタルゲストブック拡張：未着手（優先度：低） 
- [ ] パーソナライズ通知システム：未着手（優先度：低）
- [ ] ARフォトスポット機能：未着手（優先度：最低）

## 1. QRコードチェックイン機能（優先度：高）- 完了
- [x] `feature/qr-checkin` ブランチを作成
- [x] データベース拡張
  - [x] `guests` テーブルに `qr_code_token` カラムを追加
  - [x] `checkins` テーブルを新規作成（ゲストID、チェックイン時間、メモ等）
- [x] QRコード生成モジュール実装 (`includes/qr_helper.php`)
- [x] reCAPTCHA検証を開発環境でスキップする機能を追加
- [x] ゲスト用マイページにQRコード表示機能追加 (`my_qrcode.php`)
- [x] インデックスページにQRコード機能へのリンク追加
- [x] お礼ページにQRコード案内を追加
- [x] 管理者用チェックインページ実装 (`admin/checkin.php`)
- [x] チェックイン履歴管理ページ実装 (`admin/checkin_list.php`)
- [x] カメラアクセスの問題修正
  - [x] QRコードスキャナーライブラリをローカルに保存 (`admin/js/html5-qrcode.min.js`)
  - [x] カメラ初期化プロセスの改善
  - [x] エラー処理・ユーザーガイダンスの追加
- [x] チェックイン履歴表示のSQLクエリ修正
- [x] タイムゾーンを日本時間（JST）に設定
- [x] 出席回答後のみQRコードを表示する条件分岐の追加
- [x] テスト・最終確認
- [x] メインブランチへマージ

## 2. チェックイン後の案内表示機能（優先度：最高）- 完了
- [x] `feature/checkin-guidance` ブランチを作成
- [x] データベース拡張
  - [x] `seating_guidance` テーブルを作成（ゲストの席次情報保存用）
  - [x] `event_notices` テーブルを作成（イベント関連の案内情報用）
  - [x] `venue_maps` テーブルを作成（会場マップ情報用）
  - [x] `event_schedule` テーブルを作成（イベントスケジュール用）
- [x] チェックイン直後の案内画面実装
  - [x] `guidance.php` 作成：ゲスト用案内ページ
  - [x] 席次情報表示機能（テーブル番号、座席番号）
  - [x] 会場案内マップ表示機能
  - [x] 特別注意事項表示機能
  - [x] 時間スケジュール表示
- [x] 管理者用設定ページ実装
  - [x] `admin/guidance_settings.php` 作成：案内情報の管理ページ
  - [x] 席次情報一括登録機能（CSVインポート対応）
  - [x] 会場マップのアップロード機能
  - [x] イベントスケジュールの設定機能
- [x] プッシュ通知システムの実装
  - [x] `push_notification.php` 作成：通知送信用API
  - [x] `check_notification.php` 作成：通知確認用API
  - [x] チェックイン時にゲストスマホへのプッシュ通知機能
- [x] スマートフォン表示の最適化
  - [x] レスポンシブデザインの実装
  - [x] タッチ操作に最適化されたUI
- [x] メール表示の改善
  - [x] メール内QRコード表示の問題修正
  - [x] HTML互換性の向上
- [x] テスト・デバッグ
- [x] メインブランチへマージ

### デプロイ実施済み機能（チェックイン後の案内表示機能）
- [x] データベース変更の適用
  - [x] `seating_guidance` テーブル作成
  - [x] `event_notices` テーブル作成
  - [x] `venue_maps` テーブル作成
  - [x] `event_schedule` テーブル作成
  - [x] `qr_settings` テーブル作成
  - [x] `checkins` テーブル作成

## 3. 管理者用リアルタイムダッシュボード（優先度：高）- 未着手
- [ ] `feature/realtime-dashboard` ブランチを作成
- [ ] チェックイン状況のリアルタイム表示
  - [ ] 現在のチェックイン数/割合のリアルタイム表示
  - [ ] 時間帯別チェックイン数グラフ（Chart.js使用）
  - [ ] 重要ゲストのステータス表示（VIPゲスト優先表示）
  - [ ] 未チェックインの重要ゲストリスト
- [ ] 管理者向け通知機能
  - [ ] ブラウザプッシュ通知の実装（特定ゲストのチェックイン時）
  - [ ] チェックイン率閾値到達時の通知
  - [ ] 通知設定画面の実装
- [ ] 統計データ表示の強化
  - [ ] グループ別チェックイン状況（円グラフ）
  - [ ] 時系列チェックイン進捗グラフ
  - [ ] 席次表との連携表示（テーブル別チェックイン状況）
  - [ ] CSVエクスポート機能
- [ ] モバイル対応
  - [ ] レスポンシブデザイン
  - [ ] タッチ操作最適化
  - [ ] スワイプナビゲーション
- [ ] リアルタイム更新の実装
  - [ ] JavaScript Fetch APIによるポーリング
  - [ ] データキャッシュ機構
- [ ] テスト・デバッグ
- [ ] メインブランチへマージ

## 4. ブランチ戦略導入（優先度：低）- 完了
- [x] `feature/branch-strategy` ブランチを作成
- [x] Git連携の実装
- [x] GitHub リポジトリの設定
- [x] ブランチ管理方法の確立
- [x] メインブランチへマージ

## 5. デジタルゲストブック拡張（優先度：低）- 未着手
- [ ] `feature/digital-guestbook` ブランチを作成
- [ ] 写真アップロード機能の追加
- [ ] リアルタイム表示機能の実装
- [ ] 管理画面への統計情報追加
- [ ] メインブランチへマージ

## 6. パーソナライズ通知システム（優先度：低）- 未着手
- [ ] `feature/personalized-notifications` ブランチを作成
- [ ] タイムライン管理システムの実装
- [ ] ゲスト毎の通知設定ページ
- [ ] プッシュ通知の実装
- [ ] メインブランチへマージ

## 7. ARフォトスポット機能（優先度：最低）- 未着手
- [ ] `feature/ar-photospot` ブランチを作成
- [ ] ARライブラリの選定・導入
- [ ] ARマーカーとコンテンツの作成
- [ ] 専用ページの実装
- [ ] メインブランチへマージ

## 発生した問題と解決策

### QRコード表示の問題
- [x] 問題：メール内でQRコードが表示されない
- [x] 解決策：HTMLメール対応とインラインスタイルの適用、リンクボタンの改良

### 環境間の差異
- [x] 問題：ローカル環境と本番環境でのURL生成の違い
- [x] 解決策：`config.php`での環境検出と適切なURL設定

### データベース変更の反映
- [x] 問題：本番環境へのデータベース変更の適用方法
- [x] 解決策：SQLスクリプトの作成と個別実行

## 今後の課題と改善点

### パフォーマンス最適化
- [ ] 画像の最適化（WebP形式への変換、遅延読み込み）
- [ ] JavaScript/CSSの圧縮とバンドル
- [ ] データベースクエリの最適化

### セキュリティ強化
- [ ] CSRF対策の強化
- [ ] XSS対策の徹底
- [ ] レート制限の導入

### ユーザビリティ向上
- [ ] 操作性テストの実施
- [ ] ユーザーフィードバックの収集機能

## 本番環境データベース設定
本番環境へのデータベース適用は以下の手順で実施済み：

1. 各テーブル作成スクリプトをphpMyAdminで個別に実行
2. 必要なデータの初期値を設定
3. 動作確認を実施

## 開発の注意点
1. 各機能は個別のブランチで開発
2. プルリクエスト作成前にステージング環境でテスト
3. コードレビュー後にmainブランチへマージ
4. デプロイ後の動作確認を必ず実施

## 新機能実装時の基本手順

```bash
# 1. 最新のメインブランチを取得
git checkout main
git pull origin main

# 2. 機能ブランチを作成
git checkout -b feature/[機能名]

# 3. 開発・変更を実施

# 4. 変更をコミット
git add .
git commit -m "[機能名]の基本実装"

# 5. リモートへプッシュ
git push origin feature/[機能名]

# 6. GitHub上でプルリクエスト作成
# 7. レビュー後、マージ
``` 